<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
	
	<style type="text/css">
	body {
		overflow:scroll;
		margin-top:100px;
		margin-bottom: 30px;
		/* text-align: center; */
	}
	.contents-1  {
		margin: 100px;
		clear: both;
	}
	.function-box { /* = empty */
		 background-color: rgba(145, 186, 255, 0.3);
		 border-radius: 10px;
		 float: left;
		 /* height : 300px; */
		 margin: 50px;
		 padding: 35px;
		 text-align: center;
		 width: 400px;
	}
	.function-box button {
		 background-color: rgba(255, 255, 255, 0.7);
		 border-radius: 10px;
		 text-align: center;
		 margin: 10px 0px;
	}
	.function-box p {
		 background-color: rgba(255, 200, 234, 0.795);
		 border-radius: 10px;
		 text-align: center;
		 margin: 10px 15px 10px 10px;
		 padding: 5px;
		 width: 300px;
		 position: relative;
		 cursor: pointer;
	}
	
	.contents-main button { /* ë¶€ëª¨í´ë˜ìŠ¤ contents-main ë°‘ì— ìˆëŠ” ìì‹ íƒœê·¸ buttonë§Œ ì ìš© (navì˜ í–„ë²„ê±° ë²„íŠ¼ë•Œë¬¸ì—!) */
	  width: 100%;
	}

	
	.hold {
		border: dotted rgb(94, 13, 148) 3px;
	}

	.hovered {
		border-style: solid rgb(13, 148, 107) 3px;
	}

	.invisible{
		display: none;
	}
	</style>

</head>
<body>

	<!-- Navbar -->
	<nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #3B71CA;">
	    <!-- Container wrapper -->
	    <div>
	        <!-- Navbar brand -->
	        <a class="navbar-brand mt-2 mt-lg-0" href="index.html">
	            <h5 class="pt-1" href="index.html">TEAM5</h5> 
	        </a>

	        <!-- Collapsible wrapper -->
	        <div id="navbarSupportedContent" style="display: inline-block;">
	            <!-- Left links -->
	            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
	                <li class="nav-item">
	                    <a class="nav-link" href="Woonani.html">#LocalStorage</a>
	                </li>
	                <li class="nav-item">
	                    <a class="nav-link" href="WoonaniProfile.html">#profile</a>
	                </li>
	            </ul>
	            <!-- Left links -->
	        </div>
	        <!-- Collapsible wrapper -->
	    </div>
	    <!-- Container wrapper -->
	</nav>
	<!-- Navbar End -->	
	
	
	<!-- contents -->
	<div class="contents-main" >
	
		<div class="contents-1">
			<h1 id="shownick"></h1>
			<br>
			<input type="text" id="nickname" name="nickname" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" >			
			<input type="button" id="nickbtn" name="nickbtn" value="ë‹‰ë„¤ì„ ë°”ê¾¸ê¸°" onclick="setNick()">		
			<input type="button" id="nick-remove-btn" value="ì €ì¥ëœë‹‰ì‚­ì œ" onclick="removeNick()" >	
		</div>
		
		<div  class="contents-1"><hr></div>

		<div class="contents-1">
			<h1>ì¹¸ë°˜ë³´ë“œ (Drag&Drop + LocalStorage) </h1>
			<input id="inputToDo" type="text" placeholder="í• ì¼ì„ ì ì–´ì£¼ì„¸ìš”"> 
			<input id="btnToDo" type="button" value="ë“±ë¡"><br>		
			
			<div class="function-box" id="function-box1">
				<div class="toDoDropBox" id="dropdiv">
					<h4>To Do List</h4><br><br>

				</div>
				
			</div>
			
			<div class="function-box" id="function-box2">
				<div class="progressDropBox" id="dropdiv">
					<h4>In Progress</h4><br><br>

				</div>
				<!-- <div id="dragdiv" draggable="true" ondragstart="drag(event)"><i class="bi bi-apple"></i> Drag Me!</div>
				<div id="dropdiv" ondrop="drop(event)" ondragover="allowDrop(event)"><i class="bi bi-arrow-90deg-down"></i> Drop Here!<br></div>
				<br><br> -->
			</div>
			
			<div class="function-box" id="function-box3">
				<div class="doneDropBox" id="dropdiv">
					<h4>Done</h4><br> 

				</div>				
			</div>
		</div>

		
		<div  class="contents-1"><hr></div>

		<div class="contents-1">
			<h1>ì§€ê¸ˆ ë‚´ ìœ„ì¹˜ëŠ” ? </h1><br>
			<button style="width: 300px;" onclick="getLocation()">Get Location</button>
			<br><br>
			<p id="latitudeValue"> </p>
			<p id="longitudeValue"> </p> 
		</div>

	</div>
	<!-- contents End -->
	
	
	
	<!-- Footer -->
	<!-- button footer -->
	<footer class=" text-center text-white fixed-bottom "  style="background-color: rgba(0, 0, 0, 0);">	
	
	    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0); margin-bottom: -5px" >
	            <a class="btn btn-outline-light btn-floating s-1" style="border-radius: 50%; color: white; background-color: #3B71CA; "  href="#" role="button"><i class="bi bi-chevron-double-up"></i></a>
	            <!-- <a class="btn  m-1" href="https://github.com/Woonani" role="button"><i class="bi bi-github"></i></a> -->
	    </div> 
	</footer>
	<!-- copyWrite footer -->
	<footer class=" text-center text-white"  style="background-color: rgba(0, 0, 0, 0);">	
	    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0); margin-bottom: -5px" >
	           <br>
			 <a class="text-black"	href="https://citrine-sardine-be2.notion.site/TEAM-5-0a2b704b186342e09fd488f475d95551"> ğŸ“œ TEAM5 Notion </a> ||
			 <a class="text-black"	href="https://github.com/Woonani/team5FrontPJ.git"><i class="bi bi-github"> TEAM5 GitHub </i></a><br><br>
			 <a class="text-black"  href="https://www.notion.so/5-5-70506e4b0e75428aa4d4db955709678e?pvs=4">Â©ë”ì¡´5ê¸°5ì¡°</a><br><br>
	    </div> 
	   
	</footer>
	<!-- Footer --> 
 
</body>

<script type="text/javascript">
	// ë‹‰ë„¤ì„ ë¶ˆëŸ¬ì˜¤ê¸°
	window.onload = getNick();

	function getNick () {
		let nick = JSON.parse(localStorage.getItem('nickname'));
		//console.log(nick);
		document.getElementById("shownick").innerHTML = (nick == null) ? ("ë°˜ê°€ì›Œìš” ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!") : ( nick +" ë‹˜ ì¢‹ì€í•˜ë£¨ ë˜ì„¸ìš”~!");
	}
	// ë‹‰ë„¤ì„ ì¶”ê°€ í•¨ìˆ˜
	function setNick(){
		let nick = document.getElementById("nickname").value;
		localStorage.setItem("nickname", JSON.stringify(nick));
		getNick();
	}
	// ë‹‰ë„¤ì„ ì‚­ì œ í•¨ìˆ˜
	function removeNick(){
		localStorage.removeItem("nickname");
		getNick();
	}

	let toDoList =[];
	let progressList =[];
	let doneList =[];

	window.onload = ()=> {
		setToDoTags( "toDoList", ".toDoDropBox" );
		setToDoTags( "progressList", ".progressDropBox" );
		setToDoTags( "doneList", ".doneDropBox" );			
	}

	// To Do List í• ì¼ ì¶”ê°€ ì´ë²¤íŠ¸í•¨ìˆ˜
	document.getElementById("btnToDo").addEventListener("click", ()=>{
		let inputValue = document.getElementById("inputToDo").value;
		if(inputValue.trim().length <1){
			window.alert("ë¹ˆë‚´ìš©ì€ ì œì¶œ ì•ˆë¨^^");
		}else{
			let newToDo = document.getElementById("inputToDo").value;
			let newToDoTag = document.createElement("p");
			newToDoTag.innerHTML = newToDo;
			document.querySelector(".toDoDropBox").appendChild(newToDoTag);

			// toDoList ë°°ì—´ì— ì¶”ê°€í•˜ê³  LocalStorageì— ë‹´ëŠ”ë‹¤.					
			toDoList=JSON.parse(localStorage.getItem("toDoList")); // toDoList.push(newToDo); // X!! ì „ì—­ë³€ìˆ˜ toDoListì— LocalStorageì •ë³´ê°€ ì €ì¥ë˜ì–´ìˆì§€ ì•Šë‹¤.
			toDoList.push(newToDo);
			localStorage.setItem("toDoList", JSON.stringify(toDoList));	
			document.getElementById("inputToDo").value = "";
		}
	})	
	
	// toDoList ì¶”ê°€ ì‹œ enterí‚¤ë¡œ ì œì¶œí•˜ëŠ” í•¨ìˆ˜
	document.getElementById("inputToDo").addEventListener("keyup", (e)=>{
		if(e.keyCode === 13){
			event.preventDefault();
			document.getElementById("btnToDo").click();
		}
	})

	// LocalStorageì—ì„œ ìë£Œë¥¼ êº¼ë‚´ì™€ ListBoxì— íƒœê·¸ìƒì„±í•˜ëŠ” í•¨ìˆ˜
	function setToDoTags( listName, boxClassName ) {
		let tempArr = [];
		if(localStorage.getItem(listName) == null){ // ì—†ìœ¼ë©´
			//ì´ˆê¸°í™”
			if( listName == "toDoList"){
				tempArr = ["(ê¸°ë³¸)ë¬¼ë§ˆì‹œê¸°", "(ê¸°ë³¸)ì¹¸ë°˜ë§Œë“¤ê¸°"];
			}
			// else{
			// 	tempArr = [];
			// }
			localStorage.setItem(listName, JSON.stringify(tempArr));
		}else{ //ìˆìœ¼ë©´
			tempArr = JSON.parse(localStorage.getItem(listName));	
		}
		tempArr.forEach((v)=>{
			makeToDoTag (v, boxClassName);
		})
	}
	


	// to Do íƒœê·¸ ìƒì„± í•¨ìˆ˜ 
	function makeToDoTag (toDoTxt, boxClassName){
		let toDoTag = document.createElement("p"); 
		toDoTag.setAttribute("class", ".function-box p");
		toDoTag.setAttribute("id", "dragP");
		toDoTag.setAttribute("draggable", "true");
		console.log(toDoTag);
		toDoTag.innerHTML = toDoTxt;
		document.querySelector(boxClassName).appendChild(toDoTag);
		toDoTag.addEventListener("dragstart", dragStart);
		toDoTag.addEventListener("dragend", dragEnd);
	}

    let targetTag;
	let leavingBox;
	// dragStart()í•¨ìˆ˜
	function dragStart(e){
		console.log("drag start - targetTag : ", e.target)
		targetTag = e.target;
		leavingBox = targetTag.parentNode;
		this.className += ' hold';
		setTimeout(()=> (this.className='invisible'),0)
	}

	// boxë“¤ì— ì´ë²¤íŠ¸ ì¶”ê°€
	const toDoDropBox = document.querySelector(".toDoDropBox");
	const progressDropBox = document.querySelector(".progressDropBox");
	const doneDropBox = document.querySelector(".doneDropBox");

	addEventToBox(toDoDropBox);
	addEventToBox(progressDropBox);
	addEventToBox(doneDropBox);

	function addEventToBox(box){
		box.addEventListener('dragover', dragOver);
		box.addEventListener('dragenter', dragEnter);
		box.addEventListener('dragleave', dragLeave);
		box.addEventListener('drop', drapDrop);
	}

	// dragEnd()í•¨ìˆ˜
	function dragEnd(){
		console.log("dragEnd");
		this.className = 'function-box p';
	}

	//1 dragOver()í•¨ìˆ˜
	function dragOver(e){
		e.preventDefault(); // í•´ì£¼ëŠ” ì´ìœ 
		// í•˜ê¸° ì „ : dragOver > dragleave > dragEnd
		// í•˜ê³ ë‚œ í›„ : drop í•¨ìˆ˜ë¥¼ í˜¸ì¶œ
		//console.log("dragOver");
	}
	
	let enterBox;
	//2  drdragEnterop()í•¨ìˆ˜
	function dragEnter(e){
		e.preventDefault();
		//this.className += ' hovered';
		enterBox = e.target;
		//console.log("ë‚˜ë¡±dragEnter-enterBox : ", e.target); // >> BOX

	}

	//3  dragLeave()í•¨ìˆ˜
	function dragLeave(){ // eê°€ ì—†ìŒ
		//console.log("dragLeave");
		//document.removeChild(leavingBox);
	}

	function getClassName(boxName){
		if(boxName.className == "progressDropBox"){
			return "progressList";
		}else if(boxName.className == "doneDropBox"){
			return "doneList";
		}else {
			return "toDoList";
		}
	}

	//4  drop()í•¨ìˆ˜
	function drapDrop(){
		//console.log("drop");
		//console.log("drop > targetTag: ",targetTag);
		this.append(targetTag);

		//enterBoxì˜ ë°°ì—´ì— ì¶”ê°€í›„, leavingBoxì˜ ë°°ì—´ì—ì„œ ì‚­ì œ, 
		//console.log("4 leavingBox",leavingBox.className);
		//console.log("4 enterBox",enterBox.className);

		let leavingBoxName = getClassName(leavingBox);
		let leavingBoxList = JSON.parse(localStorage.getItem(leavingBoxName));
		let enterBoxName = getClassName(enterBox);
		let enterBoxList = JSON.parse(localStorage.getItem(enterBoxName));
		// console.log(leavingBoxName);

		//targetP ì¶”ê°€
		enterBoxList.push(targetTag.innerHTML)
		console.log(enterBoxList);
		localStorage.setItem(enterBoxName, JSON.stringify(enterBoxList));
		
		//targetP ì‚­ì œ
		let dropIndex = leavingBoxList.indexOf(targetTag.innerHTML);
		// console.log(dropIndex);
		leavingBoxList.splice(dropIndex,1)
		localStorage.setItem(leavingBoxName, JSON.stringify(leavingBoxList));
		
		//ë³€ìˆ˜ì´ˆê¸°í™”
		targetTag = null;
		leavingBox = null; 
		enterBox = null;
		dropIndex = -1;
	}

	// allowDrop() í•¨ìˆ˜
	function allowDrop(){
		//console.log("allowDrop");

	}

	function getLocation () {
		if("geolocation" in navigator){
			navigator.geolocation.getCurrentPosition((position) => {
				showLocation(position.coords.latitude, position.coords.longitude);
			});
		}else{
			alert("ìœ„ì¹˜ì •ë³´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
		}
	}

	function showLocation(latitude, longitude){
		document.getElementById("latitudeValue").innerHTML = "latitude : " + latitude;
		document.getElementById("longitudeValue").innerHTML = "longitude : " + longitude;
	}

</script>
</html>

